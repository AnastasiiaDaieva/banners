import refs from"./refs.js";import offerCard from"./offerCard.js";const{list:list,arrow:arrow,arrowWrapper:arrowWrapper,loader:loader}=refs,API_URL="https://veryfast.io/t/front_test_api.php",ROTATE_CLASS="rotate-180";async function fetchData(){try{const e=await fetch(API_URL).then((e=>e.json()));if(!e||"ok"!==e?.state)throw new Error("failed");return e.result.elements}catch(e){console.error(e)}}function getBrowserInfo(){const e=navigator.userAgent;let t;const r=e.match(/(chrome|firefox)\/?\s*(\d+)/i)||[];if("Chrome"===r[1]&&(t=e.match(/\bEdg\/(\d+)/),null!=t))return{name:"Edge",version:t[1]};return{name:r[1],version:r[2]}}function applyStyles(e,t){for(const t in e)arrow.style[t]=e[t];t?arrowWrapper.classList.add(ROTATE_CLASS):arrowWrapper.classList.remove(ROTATE_CLASS)}function detectCurrentBrowserAndApplyStyles(){const e=getBrowserInfo();switch(e.name.toLowerCase()){case"chrome":+e.version<115?applyStyles({bottom:"70px",left:"10px"},!0):applyStyles({top:"30px",right:"15px"});break;case"firefox":applyStyles({top:"30px",right:"35px"});break;case"edge":applyStyles({top:"30px",right:"25px"});break;default:applyStyles({top:"30px",right:"10px"})}}function setUpButtons(){document.querySelectorAll(".download").forEach((e=>{e.addEventListener("click",(()=>{arrow&&setTimeout((()=>{arrow.style.display="block"}),1500)}))}))}function buildCards(e){const t=e?.map(offerCard).join("");list&&(list.innerHTML=t)}document.addEventListener("DOMContentLoaded",(async()=>{loader.style.display="flex",detectCurrentBrowserAndApplyStyles();try{buildCards(await fetchData()),setUpButtons()}catch(e){console.log("err",e)}finally{loader.style.display="none"}}));